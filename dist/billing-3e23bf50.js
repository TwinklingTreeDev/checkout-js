"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[876],{48574:(e,t,n)=>{n.r(t),n.d(t,{default:()=>V});var r=n(97582),s=n(91074),o=n(67627),i=n(92574),a=n(19053),l=n(95593),d=n(88870),u=n(69638),c=n(55409),m=n(76741),g=n(74161),p=n(98119),h=n(76417),f=n(19686),v=n(56204),E=n(31478),C=n(97204),b=n(24648),_=n(75667),y=n(78500),A=n(96543),Z=n(34323),S=n(17175),k=n(67570),w=n(60452),F=n(16206),I=n(78379),B=n(45855),L=n(77683);const U=(0,v.Z)((0,h.withFormik)({handleSubmit:function(e,t){(0,t.props.onSubmit)(e)},mapPropsToValues:function(e){var t=e.getFields,n=e.customerMessage,s=e.billingAddress;return(0,r.__assign)((0,r.__assign)({},(0,A.Z)(t(s&&s.countryCode),s)),{orderComment:n})},isInitialValid:function(e){var t=e.billingAddress,n=e.getFields,r=e.language;return!!t&&(0,Z.Z)({language:r,formFields:n(t.countryCode)}).isValidSync(t)},validationSchema:function(e){var t=e.language,n=e.getFields;return"amazonpay"===e.methodId?(0,f.Vo)((function(e){return(0,S.Z)({translate:(0,Z.w)(t),formFields:n(e&&e.countryCode)})})):(0,f.Vo)((function(e){return(0,Z.Z)({language:t,formFields:n(e&&e.countryCode)})}))},enableReinitialize:!0})((function(e){var t=e.googleMapsApiKey,n=e.billingAddress,s=e.countriesWithAutocomplete,l=e.customer,d=l.addresses,u=l.isGuest,c=e.getFields,m=e.countries,g=e.isUpdating,p=e.setFieldValue,h=e.shouldShowOrderComments,f=e.values,v=e.methodId,A=e.isFloatingLabelEnabled,Z=e.updateAddress,S=e.onUnhandledError,U=(0,o.useState)(!1),M=U[0],z=U[1],N=(0,o.useRef)(null),V=(0,E.Z)(),O=V.isPayPalFastlaneEnabled,P=V.paypalFastlaneAddresses,K="amazonpay"===v,R=c(f.countryCode),x=R.filter((function(e){return e.custom})),W=x.length>0,T=K&&W?x:R,D=O?P:d,G=(null==D?void 0:D.length)>0,J=n&&(0,C.Z)(n,D,c(n.countryCode)),H=function(e){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:z(!0),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,Z(e)];case 2:return n.sent(),[3,5];case 3:return(t=n.sent())instanceof Error&&S(t),[3,5];case 4:return z(!1),[7];case 5:return[2]}}))}))};return o.createElement(F.Z,{autoComplete:"on"},K&&n&&o.createElement("div",{className:"form-fieldset"},o.createElement(L.Z,{address:n})),o.createElement(I.Z,{id:"checkoutBillingAddress",ref:N},G&&!K&&o.createElement(I.Z,{id:"billingAddresses"},o.createElement(B.Z,{isLoading:M},o.createElement(b.Z,{addresses:D,onSelectAddress:H,onUseNewAddress:function(){H({})},selectedAddress:J?n:void 0,type:_.Z.Billing}))),!J&&o.createElement(a.Z,{isLoading:M},o.createElement(y.Z,{countries:m,countriesWithAutocomplete:s,countryCode:f.countryCode,formFields:T,googleMapsApiKey:t,isFloatingLabelEnabled:A,setFieldValue:p,shouldShowSaveAddress:!u}))),h&&o.createElement(k.Z,null),o.createElement("div",{className:"form-actions"},o.createElement(w.ZP,{disabled:g||M,id:"checkout-billing-continue",isLoading:g||M,type:"submit",variant:w.Wu.Primary},o.createElement(i.Z,{id:"common.continue_action"}))))})));var M=n(41957);function z(e){var t=(0,M.Z)(e);return t&&["amazonpay"].indexOf(t.providerId)>-1?t.providerId:void 0}var N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSubmit=function(e){return(0,r.__awaiter)(t,void 0,void 0,(function(){var t,n,s,o,i,a,u,c,m,g,p=e.orderComment,h=(0,r.__rest)(e,["orderComment"]);return(0,r.__generator)(this,(function(e){switch(e.label){case 0:t=this.props,n=t.updateAddress,s=t.updateCheckout,o=t.customerMessage,i=t.billingAddress,a=t.navigateNextStep,u=t.onUnhandledError,c=[],(m=(0,l.Z)(h))&&!(0,d.Z)(m,i)&&c.push(n(m)),o!==p&&c.push(s({customerMessage:p})),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.all(c)];case 2:return e.sent(),a(),[3,4];case 3:return(g=e.sent())instanceof Error&&u(g),[3,4];case 4:return[2]}}))}))},t}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,o,i,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:e=this.props,t=e.initialize,n=e.onReady,o=void 0===n?s.noop:n,i=e.onUnhandledError,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t()];case 2:return r.sent(),o(),[3,4];case 3:return(a=r.sent())instanceof Error&&i(a),[3,4];case 4:return[2]}}))}))},t.prototype.render=function(){var e=this.props,t=e.updateAddress,n=e.isInitializing,s=(0,r.__rest)(e,["updateAddress","isInitializing"]);return o.createElement(a.Z,{isLoading:n},o.createElement("div",{className:"checkout-form"},o.createElement("div",{className:"form-legend-container"},o.createElement(p.Z,{testId:"billing-address-heading"},o.createElement(i.Z,{id:"billing.billing_address_heading"}))),o.createElement(U,(0,r.__assign)({},s,{onSubmit:this.handleSubmit,updateAddress:t}))))},t}(o.Component);const V=(0,u.Z)((function(e){var t=e.checkoutService,n=e.checkoutState,r=n.data,s=r.getCheckout,o=r.getConfig,i=r.getCart,a=r.getCustomer,l=r.getBillingAddress,d=r.getBillingAddressFields,u=r.getBillingCountries,p=n.statuses,h=p.isLoadingBillingCountries,f=p.isUpdatingBillingAddress,v=p.isUpdatingCheckout,E=o(),C=a(),b=s(),_=i();if(!(E&&C&&b&&_))return null;var y=E.checkoutSettings,A=y.enableOrderComments,Z=y.googleMapsApiKey,S=["US","CA","AU","NZ"];return y.features["CHECKOUT-4183.checkout_google_address_autocomplete_uk"]&&S.push("GB"),{billingAddress:l(),countries:u()||c.L,countriesWithAutocomplete:S,customer:C,customerMessage:b.customerMessage,getFields:d,googleMapsApiKey:Z,initialize:t.loadBillingAddressFields,isInitializing:h(),isUpdating:f()||v(),methodId:z(b),shouldShowOrderComments:A&&(0,g.Z)(_)<1,updateAddress:t.updateBillingAddress,updateCheckout:t.updateCheckout,isFloatingLabelEnabled:(0,m.Z)(E.checkoutSettings)}}))(N)},24994:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(97582),s=n(67627),o=n(80850),i=n(45433);const a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={shouldShow:!1},t.handleClick=function(e){t.state.shouldShow?t.handleClose(e.nativeEvent):t.handleOpen(e.nativeEvent)},t.handleOpen=function(){t.state.shouldShow||t.setState({shouldShow:!0},(function(){var e;null===(e=t.getRootElement())||void 0===e||e.addEventListener("click",t.handleClose)}))},t.handleClose=function(){t.state.shouldShow&&t.setState({shouldShow:!1},(function(){var e;null===(e=t.getRootElement())||void 0===e||e.removeEventListener("click",t.handleClose)}))},t}return(0,r.__extends)(t,e),t.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.handleClose)},t.prototype.render=function(){var e=this,t=this.props,n=t.children,i=t.placement,a=t.dropdown,l=this.state.shouldShow;return s.createElement(o.dK,null,s.createElement(o.s3,null,(function(t){var r=t.ref;return s.createElement("div",{className:"dropdownTrigger",onClick:e.handleClick,ref:r},n)})),s.createElement(o.rD,{modifiers:{hide:{enabled:!1},flip:{enabled:!1},preventOverflow:{enabled:!1}},placement:i},(function(e){var t=e.ref,n=e.style;return l?s.createElement("div",{className:"dropdownMenu",ref:t,style:(0,r.__assign)((0,r.__assign)({},n),{width:"100%",zIndex:1})},a):null})))},t.prototype.getRootElement=function(){return document.getElementById(i.V)||document.getElementById(i.Z)},t.defaultProps={placement:"bottom-start"},t}(s.Component)},45433:(e,t,n)=>{n.d(t,{V:()=>r,Z:()=>s});var r="checkout-app",s="micro-app-ng-checkout"}}]);
//# sourceMappingURL=billing-3e23bf50.js.map